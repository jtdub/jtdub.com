---
layout: post
title: 'RHCE Series: Route IP traffic and create static routes'
date: '2012-10-10T22:48:00.001-05:00'
author: jtdub
tags:
- Linux
- RHCE Study Notes
- Routing Protocols
modified_time: '2019-04-11T11:09:43.535-05:00'
blogger_id: tag:blogger.com,1999:blog-2200496390325245811.post-2788218836343081570
blogger_orig_url: https://www.packetgeek.net/2012/10/rhce-series-route-ip-traffic-and-create_10.html
---

As I start preparing for the RHCE exam, I'm attempting to go through each exam objective one by one and put together my notes on the subjects. I'll try to go trough each exam objective in the order that it's listed on it's page, but I may skip around a little bit on the objectives that very vague on what exactly they want. This first set of notes is on routing IP traffic and static routes. Enjoy.<br/><br/>There are two installed packages that can provide the same routing and information and allow you to create static routes. Those packages are net-tools and iproute.<br/><pre class="lang:default decode:true">[root@server1 ~]# yum provides /sbin/ifconfig<br/>Loaded plugins: fastestmirror<br/>Loading mirror speeds from cached hostfile<br/>net-tools-1.60-110.el6_2.x86_64 : Basic networking tools<br/>Repo        : sgn<br/>Matched from:<br/>Filename    : /sbin/ifconfig<br/><br/>net-tools-1.60-110.el6_2.x86_64 : Basic networking tools<br/>Repo        : installed<br/>Matched from:<br/>Other       : Provides-match: /sbin/ifconfig<br/><br/>[root@server1 ~]# rpm -ql net-tools<br/>/bin/dnsdomainname<br/>/bin/domainname<br/>/bin/hostname<br/>/bin/netstat<br/>/bin/nisdomainname<br/>/bin/ypdomainname<br/>/etc/ethers<br/>/sbin/arp<br/>/sbin/ether-wake<br/>/sbin/ifconfig<br/>/sbin/ipmaddr<br/>/sbin/iptunnel<br/>/sbin/mii-diag<br/>/sbin/mii-tool<br/>/sbin/nameif<br/>/sbin/plipconfig<br/>/sbin/route<br/>/sbin/slattach<br/>/usr/share/doc/net-tools-1.60<br/>/usr/share/doc/net-tools-1.60/COPYING<br/>/usr/share/locale/cs/LC_MESSAGES/net-tools.mo<br/>/usr/share/locale/de/LC_MESSAGES/net-tools.mo<br/>/usr/share/locale/et_EE/LC_MESSAGES/net-tools.mo<br/>/usr/share/locale/fr/LC_MESSAGES/net-tools.mo<br/>/usr/share/locale/pt_BR/LC_MESSAGES/net-tools.mo<br/>/usr/share/man/de/man1/dnsdomainname.1.gz<br/>/usr/share/man/de/man1/domainname.1.gz<br/>/usr/share/man/de/man1/hostname.1.gz<br/>/usr/share/man/de/man1/nisdomainname.1.gz<br/>/usr/share/man/de/man1/ypdomainname.1.gz<br/>/usr/share/man/de/man5/ethers.5.gz<br/>/usr/share/man/de/man8/arp.8.gz<br/>/usr/share/man/de/man8/ifconfig.8.gz<br/>/usr/share/man/de/man8/netstat.8.gz<br/>/usr/share/man/de/man8/plipconfig.8.gz<br/>/usr/share/man/de/man8/route.8.gz<br/>/usr/share/man/de/man8/slattach.8.gz<br/>/usr/share/man/fr/man1/dnsdomainname.1.gz<br/>/usr/share/man/fr/man1/domainname.1.gz<br/>/usr/share/man/fr/man1/hostname.1.gz<br/>/usr/share/man/fr/man1/nisdomainname.1.gz<br/>/usr/share/man/fr/man1/ypdomainname.1.gz<br/>/usr/share/man/fr/man5/ethers.5.gz<br/>/usr/share/man/fr/man8/arp.8.gz<br/>/usr/share/man/fr/man8/ifconfig.8.gz<br/>/usr/share/man/fr/man8/netstat.8.gz<br/>/usr/share/man/fr/man8/plipconfig.8.gz<br/>/usr/share/man/fr/man8/route.8.gz<br/>/usr/share/man/fr/man8/slattach.8.gz<br/>/usr/share/man/man1/dnsdomainname.1.gz<br/>/usr/share/man/man1/domainname.1.gz<br/>/usr/share/man/man1/hostname.1.gz<br/>/usr/share/man/man1/nisdomainname.1.gz<br/>/usr/share/man/man1/ypdomainname.1.gz<br/>/usr/share/man/man5/ethers.5.gz<br/>/usr/share/man/man8/arp.8.gz<br/>/usr/share/man/man8/ether-wake.8.gz<br/>/usr/share/man/man8/ifconfig.8.gz<br/>/usr/share/man/man8/ipmaddr.8.gz<br/>/usr/share/man/man8/iptunnel.8.gz<br/>/usr/share/man/man8/mii-diag.8.gz<br/>/usr/share/man/man8/mii-tool.8.gz<br/>/usr/share/man/man8/nameif.8.gz<br/>/usr/share/man/man8/netstat.8.gz<br/>/usr/share/man/man8/plipconfig.8.gz<br/>/usr/share/man/man8/route.8.gz<br/>/usr/share/man/man8/slattach.8.gz<br/>/usr/share/man/pt/man1/dnsdomainname.1.gz<br/>/usr/share/man/pt/man1/domainname.1.gz<br/>/usr/share/man/pt/man1/hostname.1.gz<br/>/usr/share/man/pt/man1/nisdomainname.1.gz<br/>/usr/share/man/pt/man1/ypdomainname.1.gz<br/>/usr/share/man/pt/man8/arp.8.gz<br/>/usr/share/man/pt/man8/ifconfig.8.gz<br/>/usr/share/man/pt/man8/netstat.8.gz<br/>/usr/share/man/pt/man8/route.8.gz</pre><br/><pre class="lang:default decode:true">[root@server1 ~]# yum provides /sbin/ip<br/>Loaded plugins: fastestmirror<br/>Loading mirror speeds from cached hostfile<br/>iproute-2.6.32-20.el6.x86_64 : Advanced IP routing and network device configuration tools<br/>Repo        : sgn<br/>Matched from:<br/>Filename    : /sbin/ip<br/><br/>iproute-2.6.32-20.el6.x86_64 : Advanced IP routing and network device configuration tools<br/>Repo        : installed<br/>Matched from:<br/>Other       : Provides-match: /sbin/ip<br/><br/>[root@server1 ~]# rpm -ql iproute<br/>/etc/iproute2<br/>/etc/iproute2/ematch_map<br/>/etc/iproute2/rt_dsfield<br/>/etc/iproute2/rt_protos<br/>/etc/iproute2/rt_realms<br/>/etc/iproute2/rt_scopes<br/>/etc/iproute2/rt_tables<br/>/etc/sysconfig/cbq<br/>/etc/sysconfig/cbq/avpkt<br/>/etc/sysconfig/cbq/cbq-0000.example<br/>/sbin/cbq<br/>/sbin/ifcfg<br/>/sbin/ip<br/>/sbin/rtmon<br/>/sbin/tc<br/>/usr/lib64/tc<br/>/usr/lib64/tc/m_xt.so<br/>/usr/sbin/arpd<br/>/usr/sbin/lnstat<br/>/usr/sbin/nstat<br/>/usr/sbin/rtacct<br/>/usr/sbin/ss<br/>/usr/share/doc/iproute-2.6.32<br/>/usr/share/doc/iproute-2.6.32/README<br/>/usr/share/doc/iproute-2.6.32/README.decnet<br/>/usr/share/doc/iproute-2.6.32/README.distribution<br/>/usr/share/doc/iproute-2.6.32/README.iproute2+tc<br/>/usr/share/doc/iproute-2.6.32/README.lnstat<br/>/usr/share/man/man8/arpd.8.gz<br/>/usr/share/man/man8/cbq.8.gz<br/>/usr/share/man/man8/ifcfg.8.gz<br/>/usr/share/man/man8/ip.8.gz<br/>/usr/share/man/man8/lnstat.8.gz<br/>/usr/share/man/man8/nstat.8.gz<br/>/usr/share/man/man8/routel.8.gz<br/>/usr/share/man/man8/rtacct.8.gz<br/>/usr/share/man/man8/rtmon.8.gz<br/>/usr/share/man/man8/ss.8.gz<br/>/usr/share/man/man8/tc-bfifo.8.gz<br/>/usr/share/man/man8/tc-cbq-details.8.gz<br/>/usr/share/man/man8/tc-cbq.8.gz<br/>/usr/share/man/man8/tc-htb.8.gz<br/>/usr/share/man/man8/tc-pfifo.8.gz<br/>/usr/share/man/man8/tc-pfifo_fast.8.gz<br/>/usr/share/man/man8/tc-prio.8.gz<br/>/usr/share/man/man8/tc-red.8.gz<br/>/usr/share/man/man8/tc-sfq.8.gz<br/>/usr/share/man/man8/tc-tbf.8.gz<br/>/usr/share/man/man8/tc.8.gz<br/>/usr/share/tc<br/>/usr/share/tc/normal.dist<br/>/usr/share/tc/pareto.dist<br/>/usr/share/tc/paretonormal.dist</pre><br/>&nbsp;<br/><br/>Above, you will see the package description, as well as the files that are installed with each package. Net-tools is the old tools and are pretty much kept around for compatibility. I personally like the output of the ifconfig and the route command better than I do the ip command, but as ifconfig and route are pretty much depreciated and will be going away at some point, I'll focus my notes on the command sequence of the ip command.<br/><br/>ip command structure:<br/><pre>[root@server1 ~]# ip route help<br/>Usage: ip route { list | flush } SELECTOR<br/>       ip route get ADDRESS [ from ADDRESS iif STRING ]<br/>                            [ oif STRING ]  [ tos TOS ]<br/>       ip route { add | del | change | append | replace | monitor } ROUTE<br/>SELECTOR := [ root PREFIX ] [ match PREFIX ] [ exact PREFIX ]<br/>            [ table TABLE_ID ] [ proto RTPROTO ]<br/>            [ type TYPE ] [ scope SCOPE ]<br/>ROUTE := NODE_SPEC [ INFO_SPEC ]<br/>NODE_SPEC := [ TYPE ] PREFIX [ tos TOS ]<br/>             [ table TABLE_ID ] [ proto RTPROTO ]<br/>             [ scope SCOPE ] [ metric METRIC ]<br/>INFO_SPEC := NH OPTIONS FLAGS [ nexthop NH ]...<br/>NH := [ via ADDRESS ] [ dev STRING ] [ weight NUMBER ] NHFLAGS<br/>OPTIONS := FLAGS [ mtu NUMBER ] [ advmss NUMBER ]<br/>           [ rtt TIME ] [ rttvar TIME ] [reordering NUMBER ]<br/>           [ window NUMBER] [ cwnd NUMBER ] [ initcwnd NUMBER ]<br/>           [ ssthresh NUMBER ] [ realms REALM ] [ src ADDRESS ]<br/>           [ rto_min TIME ] [ hoplimit NUMBER ] <br/>TYPE := [ unicast | local | broadcast | multicast | throw |<br/>          unreachable | prohibit | blackhole | nat ]<br/>TABLE_ID := [ local | main | default | all | NUMBER ]<br/>SCOPE := [ host | link | global | NUMBER ]<br/>FLAGS := [ equalize ]<br/>MP_ALGO := { rr | drr | random | wrandom }<br/>NHFLAGS := [ onlink | pervasive ]<br/>RTPROTO := [ kernel | boot | static | NUMBER ]<br/>TIME := NUMBER[s|ms|us|ns|j]</pre><br/>ip route {list, add, delete}:<br/><pre>[root@server1 ~]# ip route list<br/>192.168.122.0/24 dev eth0  proto kernel  scope link  src 192.168.122.101 <br/>169.254.0.0/16 dev eth0  scope link  metric 1002 <br/>default via 192.168.122.1 dev eth0 <br/>[root@server1 ~]# ip route add 192.168.100.0/24 via 192.168.122.1 dev eth0<br/>[root@server1 ~]# ip route list<br/>192.168.100.0/24 via 192.168.122.1 dev eth0 <br/>192.168.122.0/24 dev eth0  proto kernel  scope link  src 192.168.122.101 <br/>169.254.0.0/16 dev eth0  scope link  metric 1002 <br/>default via 192.168.122.1 dev eth0 <br/>[root@server1 ~]# ip route del 192.168.100.0/24 via 192.168.122.1 dev eth0<br/>[root@server1 ~]# ip route list<br/>192.168.122.0/24 dev eth0  proto kernel  scope link  src 192.168.122.101 <br/>169.254.0.0/16 dev eth0  scope link  metric 1002 <br/>default via 192.168.122.1 dev eth0</pre><br/>Let's break it down:<br/><ul><br/>	<li>'ip route add' - add a route</li><br/>	<li>192.168.100.0/24 - the destination network</li><br/>	<li>'via 192.168.122.1' - the gateway to reach the 192.168.100.0/24 network.</li><br/>	<li>'dev eth0' - the interface to send the traffic to both the gateway and destination network.</li><br/></ul><br/>The 'dev eth0' is optional.<br/><br/>To make static routes persistent, you can create a static-routes file in /etc/sysconfig/. This file is already referenced in the network init script.<br/><pre>[root@server1 ~]# grep route /etc/init.d/network<br/> # Add non interface-specific static-routes.<br/> if [ -f /etc/sysconfig/static-routes ]; then<br/>    grep "^any" /etc/sysconfig/static-routes | while read ignore args ; do<br/>              /sbin/route add -$args</pre><br/>The 'static-routes' file has a similar syntax to the 'route' command. The reason for that is because the network init script uses the route command when it reads the static-routes file! That syntax is:<br/><br/>An example would be:<br/><br/>&nbsp;<br/><pre>[root@server1 sysconfig]# cat static-routes <br/>any net 192.168.100.0 netmask 255.255.255.0 gw 192.168.122.1 dev eth0</pre><br/>The next option would be to add a route-dev file in /etc/sysconfig/network-scripts.<br/><br/>An example of this file would be:<br/><br/>&nbsp;<br/><pre class="crayon-selected">[root@server1 network-scripts]# cat route-eth0 <br/>192.168.100.0/24 via 192.168.122.1 dev eth0</pre>