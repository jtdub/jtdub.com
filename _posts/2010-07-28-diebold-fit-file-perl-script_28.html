---
layout: post
title: Diebold FIT File Perl Script
date: '2010-07-28T16:29:00.001-05:00'
author: jtdub
tags:
- Diebold
- Perl Tips
- packetgeek.net
---

I wrote this to generate Diebold FIT files quickly. This script can generate a FIT file in a couple seconds in what would take me hours to do by hand.
<br/>
<pre class="lang:default decode:true">#!/usr/bin/perl<br/>#!C:\perl\bin\perl.exe<br/><br/># May, 29, 2009<br/># Automatically creates a Diebold ATM FIT file<br/># based on a list of BIN numbers.<br/><br/># 1) Takes each BIN number.<br/># 2) splits each BIN into two digit strings.<br/># 3) Assumes that each two digit string is a hex value.<br/># 4) Converts each hex value to decimal.<br/># 5) Makes sure each decimal number is three digits.<br/># 6) Creates the each incrementing FIT line.<br/># 7) Writes each FIT line to a specified file.<br/><br/># If you are using a UNIX-Like OS, be sure to change<br/># the \\ in the $binPath, $fitPath, and $testPath<br/># so a single /<br/><br/># User Definable Variables<br/># The directory in which the script looks for the input file<br/># and writes the output file(s).<br/>$homeDir  = 'C:\Documents and Settings\williamsj\My Documents';<br/>$binList  = "$ARGV[0]";<br/>$fitList  = "$ARGV[1]";<br/>$binPath = "$homeDir\\$binList";<br/>$fitPath = "$homeDir\\$fitList";<br/># Do you want to add a FIT line so that the ATM can use<br/># a settlement card?<br/>$settleCard = "1"; # 1 is On, 0 is Off<br/># Do you want to add a FIT line so that all other FI<br/># cards are defined? (Not "ON US")<br/>$allOtherFI = "1"; # 1 is On, 0 is Off<br/># Having problems? Turning this on will create a file<br/># that has all corresponding outputs. It can be useful in<br/># troubleshooting the code.<br/># 1) BIN length<br/># 2) The BIN number<br/># 3) The hex values<br/># 4) The decimal values<br/>$testData  = "0"; # 1 is On, 0 is Off<br/>$testFile  = "testData.txt";<br/>$testPath = "$homeDir\\$testFile";<br/><br/># This is the meat of the script.<br/>$num = "0";<br/>if(!$ARGV[0]) {<br/> print "Error: You must specify a bin list.\n";<br/>        print "$0 &lt;input_bin_list&gt; &lt;output_fit_file&gt;\n";<br/>} elsif(!$ARGV[1]) {<br/> print "Error: You must specify a fit file to write to.\n";<br/>        print "$0 &lt;input_bin_list&gt; &lt;output_fit_file&gt;\n";<br/>} else {<br/>if($settleCard eq 1) {<br/> open(FIT, "&gt;$fitPath") or die "Can't open $fitPath.\n";<br/> print FIT "; Settlement card BIN (all 9's)\n";<br/> print FIT "000000153153153153153002000140000000000031000255000000000000000000000000000000000000000000000000000000000000000000000\c\\n";<br/> print FIT "; on-us BINs\n";<br/> close(FIT);<br/>}<br/>open(BINS, "$binPath") or die "Can't open $binPath.\n";<br/>my @bins = ;<br/>foreach $bins (@bins) {<br/> chomp($bins);<br/>        $l = length($bins);<br/>        @sbins = split(/(\d\d)/,$bins);<br/> if($l eq 10) {<br/>         @b = ($sbins[1],$sbins[3],$sbins[5],$sbins[7],$sbins[9]);<br/>                @dec = @b;<br/>                $dec[0] = hex($dec[0]);<br/>                if(length($dec[0]) eq 2) {<br/>                 $dec[0] = "0$dec[0]";<br/>                } elsif(length($dec[0]) eq 1) {<br/>                 $dec[0] = "00$dec[0]";<br/>                }<br/>                $dec[1] = hex($dec[1]);<br/>                if(length($dec[1]) eq 2) {<br/>                 $dec[1] = "0$dec[1]";<br/>                } elsif(length($dec[1]) eq 1) {<br/>                 $dec[1] = "00$dec[1]";<br/>                }<br/>                $dec[2] = hex($dec[2]);<br/>                if(length($dec[2]) eq 2) {<br/>                 $dec[2] = "0$dec[2]";<br/>                } elsif(length($dec[2]) eq 1) {<br/>                 $dec[2] = "00$dec[2]";<br/>                }<br/>                $dec[3] = hex($dec[3]);<br/>                if(length($dec[3]) eq 2) {<br/>                 $dec[3] = "0$dec[3]";<br/>                } elsif(length($dec[3]) eq 1) {<br/>                 $dec[3] = "00$dec[3]";<br/>                }<br/>                $dec[4] = hex($dec[4]);<br/>                if(length($dec[4]) eq 2) {<br/>                 $dec[4] = "0$dec[4]";<br/>                } elsif(length($dec[4]) eq 1) {<br/>                 $dec[4] = "00$dec[4]";<br/>                }<br/> }<br/>        if($l eq 9) {<br/>         @b = ($sbins[1],$sbins[3],$sbins[5],$sbins[7],$sbins[8]);<br/>                $b[4] = "$b[4]f";<br/>                @dec = @b;<br/>                $dec[0] = hex($dec[0]);<br/>                if(length($dec[0]) eq 2) {<br/>                 $dec[0] = "0$dec[0]";<br/>                } elsif(length($dec[0]) eq 1) {<br/>                 $dec[0] = "00$dec[0]";<br/>                }<br/>                $dec[1] = hex($dec[1]);<br/>                if(length($dec[1]) eq 2) {<br/>                 $dec[1] = "0$dec[1]";<br/>                } elsif(length($dec[1]) eq 1) {<br/>                 $dec[1] = "00$dec[1]";<br/>                }<br/>                $dec[2] = hex($dec[2]);<br/>                if(length($dec[2]) eq 2) {<br/>                 $dec[2] = "0$dec[2]";<br/>                } elsif(length($dec[2]) eq 1) {<br/>                 $dec[2] = "00$dec[2]";<br/>                }<br/>                $dec[3] = hex($dec[3]);<br/>                if(length($dec[3]) eq 2) {<br/>                 $dec[3] = "0$dec[3]";<br/>                } elsif(length($dec[3]) eq 1) {<br/>                 $dec[3] = "00$dec[3]";<br/>                }<br/>                $dec[4] = hex($dec[4]);<br/>                if(length($dec[4]) eq 2) {<br/>                 $dec[4] = "0$dec[4]";<br/>                } elsif(length($dec[4]) eq 1) {<br/>                 $dec[4] = "00$dec[4]";<br/>                }<br/>        }<br/>        if($l eq 8) {<br/>         @b = ($sbins[1],$sbins[3],$sbins[5],$sbins[7]);<br/>                @dec = @b;<br/>                $dec[0] = hex($dec[0]);<br/>                if(length($dec[0]) eq 2) {<br/>                 $dec[0] = "0$dec[0]";<br/>                } elsif(length($dec[0]) eq 1) {<br/>                 $dec[0] = "00$dec[0]";<br/>                }<br/>                $dec[1] = hex($dec[1]);<br/>                if(length($dec[1]) eq 2) {<br/>                 $dec[1] = "0$dec[1]";<br/>                } elsif(length($dec[1]) eq 1) {<br/>                 $dec[1] = "00$dec[1]";<br/>                }<br/>                $dec[2] = hex($dec[2]);<br/>                if(length($dec[2]) eq 2) {<br/>                 $dec[2] = "0$dec[2]";<br/>                } elsif(length($dec[2]) eq 1) {<br/>                 $dec[2] = "00$dec[2]";<br/>                }<br/>                $dec[3] = hex($dec[3]);<br/>                if(length($dec[3]) eq 2) {<br/>                 $dec[3] = "0$dec[3]";<br/>                } elsif(length($dec[3]) eq 1) {<br/>                 $dec[3] = "00$dec[3]";<br/>                }<br/>        }<br/>        if($l eq 7) {<br/>         @b = ($sbins[1],$sbins[3],$sbins[5],$sbins[6]);<br/>                $b[3] = "$b[3]f";<br/>                @dec = @b;<br/>                $dec[0] = hex($dec[0]);<br/>                if(length($dec[0]) eq 2) {<br/>                 $dec[0] = "0$dec[0]";<br/>                } elsif(length($dec[0]) eq 1) {<br/>                 $dec[0] = "00$dec[0]";<br/>                }<br/>                $dec[1] = hex($dec[1]);<br/>                if(length($dec[1]) eq 2) {<br/>                 $dec[1] = "0$dec[1]";<br/>                } elsif(length($dec[1]) eq 1) {<br/>                 $dec[1] = "00$dec[1]";<br/>                }<br/>                $dec[2] = hex($dec[2]);<br/>                if(length($dec[2]) eq 2) {<br/>                 $dec[2] = "0$dec[2]";<br/>                } elsif(length($dec[2]) eq 1) {<br/>                 $dec[2] = "00$dec[2]";<br/>                }<br/>                $dec[3] = hex($dec[3]);<br/>                if(length($dec[3]) eq 2) {<br/>                 $dec[3] = "0$dec[3]";<br/>                } elsif(length($dec[2]) eq 1) {<br/>                 $dec[2] = "00$dec[2]";<br/>                }<br/>        }<br/>        if($l eq 6) {<br/>         @b = ($sbins[1],$sbins[3],$sbins[5]);<br/>                @dec = @b;<br/>                $dec[0] = hex($dec[0]);<br/>                if(length($dec[0]) eq 2) {<br/>                 $dec[0] = "0$dec[0]";<br/>                } elsif(length($dec[0]) eq 1) {<br/>                 $dec[0] = "00$dec[0]";<br/>                }<br/>                $dec[1] = hex($dec[1]);<br/>                if(length($dec[1]) eq 2) {<br/>                 $dec[1] = "0$dec[1]";<br/>                } elsif(length($dec[1]) eq 1) {<br/>                 $dec[1] = "00$dec[1]";<br/>                }<br/>                $dec[2] = hex($dec[2]);<br/>                if(length($dec[2]) eq 2) {<br/>                 $dec[2] = "0$dec[2]";<br/>                } elsif(length($dec[2]) eq 1) {<br/>                 $dec[2] = "00$dec[2]";<br/>                }<br/>        }<br/>        if($l eq 5) {<br/>         @b = ($sbins[1],$sbins[3],$sbins[4]);<br/>                $b[2] = "$b[2]f";<br/>                @dec = @b;<br/>                $dec[0] = hex($dec[0]);<br/>                if(length($dec[0]) eq 2) {<br/>                 $dec[0] = "0$dec[0]";<br/>                } elsif(length($dec[0]) eq 1) {<br/>                 $dec[0] = "00$dec[0]";<br/>                }<br/>                $dec[1] = hex($dec[1]);<br/>                if(length($dec[1]) eq 2) {<br/>                 $dec[1] = "0$dec[1]";<br/>                } elsif(length($dec[1]) eq 1) {<br/>                 $dec[1] = "00$dec[1]";<br/>                }<br/>                $dec[2] = hex($dec[2]);<br/>                if(length($dec[2]) eq 2) {<br/>                 $dec[2] = "0$dec[2]";<br/>                } elsif(length($dec[2]) eq 1) {<br/>                 $dec[2] = "00$dec[2]";<br/>                }<br/>        }<br/>        if($l eq 4) {<br/>         @b = ($sbins[1],$sbins[3]);<br/>                @dec = @b;<br/>                $dec[0] = hex($dec[0]);<br/>                if(length($dec[0]) eq 2) {<br/>                 $dec[0] = "0$dec[0]";<br/>                } elsif(length($dec[0]) eq 1) {<br/>                 $dec[0] = "00$dec[0]";<br/>                }<br/>                $dec[1] = hex($dec[1]);<br/>                if(length($dec[1]) eq 2) {<br/>                 $dec[1] = "0$dec[1]";<br/>                } elsif(length($dec[1]) eq 1) {<br/>                 $dec[1] = "00$dec[1]";<br/>                }<br/>        }<br/>        if($l eq 3) {<br/>         @b = ($sbins[1],$sbins[2]);<br/>                $b[1] = "$b[1]f";<br/>                @dec = @b;<br/>                $dec[0] = hex($dec[0]);<br/>                if(length($dec[0]) eq 2) {<br/>                 $dec[0] = "0$dec[0]";<br/>                } elsif(length($dec[0]) eq 1) {<br/>                 $dec[0] = "00$dec[0]";<br/>                }<br/>                $dec[1] = hex($dec[1]);<br/>                if(length($dec[1]) eq 2) {<br/>                 $dec[1] = "0$dec[1]";<br/>                } elsif(length($dec[1]) eq 1) {<br/>                 $dec[1] = "00$dec[1]";<br/>                }<br/>        }<br/>        if($l eq 2) {<br/>         @b = ($sbins[1]);<br/>                @dec = @b;<br/>                $dec[0] = hex($dec[0]);<br/>                if(length($dec[0]) eq 2) {<br/>                 $dec[0] = "0$dec[0]";<br/>                } elsif(length($dec[0]) eq 1) {<br/>                 $dec[0] = "00$dec[0]";<br/>                }<br/>        }<br/>        if($l eq 1) {<br/>         @b = ($sbins[0]);<br/>                $b[0] = "$b[0]f";<br/>                @dec = @b;<br/>                $dec[0] = hex($dec[0]);<br/>                if(length($dec[0]) eq 2) {<br/>                 $dec[0] = "0$dec[0]";<br/>                } elsif(length($dec[0]) eq 1) {<br/>                 $dec[0] = "00$dec[0]";<br/>                }<br/>        }<br/>        if($testData eq 1) {<br/>         open(FILE, "&gt;&gt;$testPath")<br/>                 or die "can't open file: $testFile.\n";<br/>                print FILE "BIN Length: $l\n";<br/>                print FILE "BINS: $bins\n";<br/>                print FILE "HEX:  @b\n";<br/>         print FILE "DEC:  @dec\n\n";<br/>         close(FILE);<br/>        }<br/>        $d = "@dec";<br/>        $d =~ s/ //g;<br/>        $dl = length($d);<br/>        if($dl eq 3) {<br/>         $d = "$d 255255255255";<br/>                $d =~ s/ //g;<br/>        } if($dl eq 6) {<br/>         $d = "$d 255255255";<br/>                $d =~ s/ //g;<br/>        } if($dl eq 9) {<br/>         $d = "$d 255255";<br/>                $d =~ s/ //g;<br/>        } if($dl eq 12) {<br/>         $d = "$d 255";<br/>                $d =~ s/ //g;<br/>        }<br/>        open(FIT, "&gt;&gt;$fitPath") or die "Can't Open $fitPath.\n";<br/>        foreach($d) {<br/>         chomp($d);<br/>                $num++;<br/>                if($num &lt;= "09") {<br/>                 $fl = "00 $num 000 $d 001000140000000000031000255000000000000000000000000000000000000000000000000000000000000000000000";<br/>                        $fl =~ s/ //g;<br/>                        print FIT "$fl\c\\n";<br/>                }<br/>                if($num &gt;= "10" &amp;&amp; $num &lt;= "99") {<br/>                 $fl = "0 $num 000 $d 001000140000000000031000255000000000000000000000000000000000000000000000000000000000000000000000";<br/>                        $fl =~ s/ //g;<br/>                        print FIT "$fl\c\\n";<br/>                }<br/>                if($num &gt;= "100" &amp;&amp; $num &lt;= "999") {<br/>                 $fl = "$num 000 $d 001000140000000000031000255000000000000000000000000000000000000000000000000000000000000000000000";<br/>                        $fl =~ s/ //g;<br/>                        print FIT "$fl\c\\n";<br/>                }<br/>        }<br/>        close(FIT);<br/>}<br/>if($allOtherFI eq 1) {<br/>        $num++;<br/>       open(FIT, "&gt;&gt;$fitPath") or die "Can't open $fitPath.\n";<br/>        print FIT "; foreign BINs (All F's)\n";<br/>        if($num &lt;= "09") {<br/>                $fl = "00 $num 000255255255255255000000140000000000031000255000000000000000000000000000000000000000000000000000000000000000000000";<br/>                $fl =~ s/ //g;<br/>                print FIT "$fl\c\\n";<br/>        } elsif($num &gt;= "10" &amp;&amp; $num &lt;= "99") {<br/>               $fl = "0 $num 000255255255255255000000140000000000031000255000000000000000000000000000000000000000000000000000000000000000000000";<br/>                $fl =~ s/ //g;<br/>                print FIT "$fl\c\\n";<br/>        } elsif($num &gt;= "100" &amp;&amp; $num &lt;= "999") {<br/>               $fl = "$num 000255255255255255000000140000000000031000255000000000000000000000000000000000000000000000000000000000000000000000";<br/>                $fl =~ s/ //g;<br/>                print FIT "$fl\c\\n";<br/>        }<br/>        close(FIT);<br/>}<br/>close(BINS);<br/>}</pre>
<br/>
