---
layout: post
title: Cisco Auto Secure
date: '2011-10-10T06:13:00.001-05:00'
author: jtdub
tags:
- IOS
- Security
- IOS Security
- packetgeek.net
---

I recently found a new command to help with the securing of Cisco Routers. The command is "
<a href="http://www.cisco.com/univercd/cc/td/doc/product/software/ios123/123newft/123_1/ftatosec.htm">
 auto secure
</a>
", which is executed from privileged enable mode. When executed, it asks a few questions and executes several commands based on security best practices for Cisco Routers. Below is an example from a router in my test lab.
<br/>
<br/>
<pre>2610-4#sh run<br/>Building configuration...<br/>Current configuration : 750 bytes<br/>!<br/>version 12.3<br/>service timestamps debug datetime msec<br/>service timestamps log datetime msec<br/>no service password-encryption<br/>!<br/>hostname 2610-4<br/>!<br/>boot-start-marker<br/>boot-end-marker<br/>!<br/>!<br/>no aaa new-model<br/>ip subnet-zero<br/>ip cef<br/>!<br/>!<br/>!<br/>!<br/>!<br/>!<br/>!<br/>!<br/>interface Ethernet0/0<br/> no ip address<br/> shutdown<br/> half-duplex<br/>!<br/>interface Serial1/0<br/> ip address 10.1.0.1 255.255.255.0<br/> encapsulation ppp<br/> clock rate 128000<br/>!<br/>interface Serial1/1<br/> no ip address<br/> shutdown<br/>!<br/>interface Serial1/2<br/> no ip address<br/> shutdown<br/>!<br/>interface Serial1/3<br/> ip address 10.0.1.2 255.255.255.0<br/>!<br/>router ospf 1<br/> router-id 10.0.1.2<br/> log-adjacency-changes<br/> network 10.0.1.0 0.0.0.255 area 0<br/> network 10.1.0.0 0.0.0.255 area 2<br/>!<br/>ip http server<br/>ip classless<br/>!<br/>!<br/>!<br/>line con 0<br/>line aux 0<br/>line vty 0 4<br/>!<br/>!<br/>end<br/>2610-4#auto<br/>2610-4#auto se<br/>2610-4#auto secure<br/>                --- AutoSecure Configuration ---<br/>*** AutoSecure configuration enhances the security of<br/>the router, but it will not make it absolutely resistant<br/>to all security attacks ***<br/>AutoSecure will modify the configuration of your device.<br/>All configuration changes will be shown. For a detailed<br/>explanation of how the configuration changes enhance security<br/>and any possible side effects, please refer to Cisco.com for<br/>Autosecure documentation.<br/>At any prompt you may enter '?' for help.<br/>Use ctrl-c to abort this session at any prompt.<br/>If this device is being managed by a network management station,<br/>AutoSecure configuration may block network management traffic.<br/>Continue with AutoSecure? [no]: yes<br/>Gathering information about the router for AutoSecure<br/>Is this router connected to internet? [no]:<br/>Securing Management plane services...<br/>Disabling service finger<br/>Disabling service pad<br/>Disabling udp &amp; tcp small servers<br/>Enabling service password encryption<br/>Enabling service tcp-keepalives-in<br/>Enabling service tcp-keepalives-out<br/>Disabling the cdp protocol<br/>Disabling the bootp server<br/>Disabling the http server<br/>Disabling the finger service<br/>Disabling source routing<br/>Disabling gratuitous arp<br/>Here is a sample Security Banner to be shown<br/>at every access to device. Modify it to suit your<br/>enterprise requirements.<br/>Authorized Access only<br/>  This system is the property of So-&amp;-So-Enterprise.<br/>  UNAUTHORIZED ACCESS TO THIS DEVICE IS PROHIBITED.<br/>  You must have explicit permission to access this<br/>  device. All activities performed on this device<br/>  are logged. Any violations of access policy will result<br/>  in disciplinary action.<br/>Enter the security banner {Put the banner between<br/>k and k, where k is any character}:<br/>#<br/>Authorized Access only<br/>  This system is the property of So-&amp;-So-Enterprise.<br/>  UNAUTHORIZED ACCESS TO THIS DEVICE IS PROHIBITED.<br/>  You must have explicit permission to access this<br/>  device. All activities performed on this device<br/>  are logged. Any violations of access policy will result<br/>  in disciplinary action.<br/>#<br/>Enable secret is either not configured or<br/> is the same as the enable password<br/>Enter the new enable secret:<br/>Confirm the enable secret :<br/>Enable password is not configured or its length<br/>is less than minimum no. of characters configured<br/>Enter the new enable password:<br/>Confirm the enable password:<br/>Configuration of local user database<br/>Enter the username: james<br/>Enter the password:<br/>Confirm the password:<br/>Configuring AAA local authentication<br/>Configuring Console, Aux and VTY lines for<br/>local authentication, exec-timeout, and transport<br/>Configuring interface specific AutoSecure services<br/>Disabling the following ip services on all interfaces:<br/> no ip redirects<br/> no ip proxy-arp<br/> no ip unreachables<br/> no ip directed-broadcast<br/> no ip mask-reply<br/>Securing Forwarding plane services...<br/>Enabling CEF (This might impact the memory requirements for your platform)<br/>This is the configuration generated:<br/>no service finger<br/>no service pad<br/>no service udp-small-servers<br/>no service tcp-small-servers<br/>service password-encryption<br/>service tcp-keepalives-in<br/>service tcp-keepalives-out<br/>no cdp run<br/>no ip bootp server<br/>no ip http server<br/>no ip finger<br/>no ip source-route<br/>no ip gratuitous-arps<br/>banner #<br/>Authorized Access only<br/>  This system is the property of So-&amp;-So-Enterprise.<br/>  UNAUTHORIZED ACCESS TO THIS DEVICE IS PROHIBITED.<br/>  You must have explicit permission to access this<br/>  device. All activities performed on this device<br/>  are logged. Any violations of access policy will result<br/>  in disciplinary action.<br/>#<br/>security passwords min-length 6<br/>security authentication failure rate 10 log<br/>enable secret 5 $1$U3Md$NLdPY5lpIOUf8Ht9L5omi/<br/>enable password 7 00141215170A5955<br/>username james password 7 082B4D5900405D40<br/>aaa new-model<br/>aaa authentication login local_auth local<br/>line console 0<br/> login authentication local_auth<br/> exec-timeout 5 0<br/> transport output telnet<br/>line aux 0<br/> login authentication local_auth<br/> exec-timeout 10 0<br/> transport output telnet<br/>line vty 0 4<br/> login authentication local_auth<br/> transport input telnet<br/>service timestamps debug datetime localtime show-timezone msec<br/>service timestamps log datetime localtime show-timezone msec<br/>logging facility local2<br/>logging trap debugging<br/>service sequence-numbers<br/>logging console critical<br/>logging buffered<br/>int Ethernet0/0<br/> no ip redirects<br/> no ip proxy-arp<br/> no ip unreachables<br/> no ip directed-broadcast<br/> no ip mask-reply<br/>int Serial1/0<br/> no ip redirects<br/> no ip proxy-arp<br/> no ip unreachables<br/> no ip directed-broadcast<br/> no ip mask-reply<br/>int Serial1/1<br/> no ip redirects<br/> no ip proxy-arp<br/> no ip unreachables<br/> no ip directed-broadcast<br/> no ip mask-reply<br/>int Serial1/2<br/> no ip redirects<br/> no ip proxy-arp<br/> no ip unreachables<br/> no ip directed-broadcast<br/> no ip mask-reply<br/>int Serial1/3<br/> no ip redirects<br/> no ip proxy-arp<br/> no ip unreachables<br/> no ip directed-broadcast<br/> no ip mask-reply<br/>ip cef<br/>!<br/>end<br/><br/>Apply this configuration to running-config? [yes]: yes<br/>Applying the config generated to running-config<br/>2610-4#<br/>2610-4#sh run<br/>Building configuration...<br/>Current configuration : 2122 bytes<br/>!<br/>version 12.3<br/>no service pad<br/>service tcp-keepalives-in<br/>service tcp-keepalives-out<br/>service timestamps debug datetime msec localtime show-timezone<br/>service timestamps log datetime msec localtime show-timezone<br/>service password-encryption<br/>service sequence-numbers<br/>!<br/>hostname 2610-4<br/>!<br/>boot-start-marker<br/>boot-end-marker<br/>!<br/>security authentication failure rate 10 log<br/>security passwords min-length 6<br/>logging buffered 4096 debugging<br/>logging console critical<br/>enable secret 5 $1$U3Md$NLdPY5lpIOUf8Ht9L5omi/<br/>enable password 7 00141215170A5955<br/>!<br/>aaa new-model<br/>!<br/>!<br/>aaa authentication login local_auth local<br/>aaa session-id common<br/>ip subnet-zero<br/>no ip source-route<br/>no ip gratuitous-arps<br/>ip cef<br/>!<br/>!<br/>!<br/>no ip bootp server<br/>!<br/>username james password 7 082B4D5900405D40<br/>!<br/>!<br/>!<br/>!<br/>interface Ethernet0/0<br/> no ip address<br/> no ip redirects<br/> no ip unreachables<br/> no ip proxy-arp<br/> shutdown<br/> half-duplex<br/>!<br/>interface Serial1/0<br/> ip address 10.1.0.1 255.255.255.0<br/> no ip redirects<br/> no ip unreachables<br/> no ip proxy-arp<br/> encapsulation ppp<br/> clock rate 128000<br/>!<br/>interface Serial1/1<br/> no ip address<br/> no ip redirects<br/> no ip unreachables<br/> no ip proxy-arp<br/> shutdown<br/>!<br/>interface Serial1/2<br/> no ip address<br/> no ip redirects<br/> no ip unreachables<br/> no ip proxy-arp<br/> shutdown<br/>!<br/>interface Serial1/3<br/> ip address 10.0.1.2 255.255.255.0<br/> no ip redirects<br/> no ip unreachables<br/> no ip proxy-arp<br/>!<br/>router ospf 1<br/> router-id 10.0.1.2<br/> log-adjacency-changes<br/> network 10.0.1.0 0.0.0.255 area 0<br/> network 10.1.0.0 0.0.0.255 area 2<br/>!<br/>no ip http server<br/>ip classless<br/>!<br/>!<br/>logging trap debugging<br/>logging facility local2<br/>no cdp run<br/>banner motd ^C<br/>Authorized Access only<br/>  This system is the property of So-&amp;-So-Enterprise.<br/>  UNAUTHORIZED ACCESS TO THIS DEVICE IS PROHIBITED.<br/>  You must have explicit permission to access this<br/>  device. All activities performed on this device<br/>  are logged. Any violations of access policy will result<br/>  in disciplinary action.<br/>^C<br/>!<br/>line con 0<br/> exec-timeout 5 0<br/> login authentication local_auth<br/> transport output telnet<br/>line aux 0<br/> login authentication local_auth<br/> transport output telnet<br/>line vty 0 4<br/> login authentication local_auth<br/> transport input telnet<br/>!<br/>!<br/></pre>