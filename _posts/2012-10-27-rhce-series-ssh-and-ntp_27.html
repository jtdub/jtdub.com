---
layout: post
title: 'RHCE Series: SSH and NTP'
date: '2012-10-27T17:38:00.001-05:00'
author: jtdub
tags:
- Linux
- NTP
- RHCE Study Notes
- OpenSSH
- SSH
modified_time: '2019-04-11T11:09:48.988-05:00'
blogger_id: tag:blogger.com,1999:blog-2200496390325245811.post-4937556699505140366
blogger_orig_url: https://www.packetgeek.net/2012/10/rhce-series-ssh-and-ntp_27.html
---

SSH<br/><ul><br/>	<li>Configure key-based authentication.</li><br/>	<li>Configure additional options described in documentation.</li><br/></ul><br/>NTP<br/><ul><br/>	<li>Synchronize time using other NTP peers.</li><br/></ul><br/>In Red Hat 6 (and I'm sure in 5 as well), public key authentication is enabled by default, but if you're unsure, you can uncomment the option and verify that it is set to yes.<br/><br/>&nbsp;<br/><pre>[root@server1 ~]# vim /etc/ssh/sshd_config <br/>[root@server1 ~]# egrep 'PubkeyAuthentication|AuthorizedKeysFile' /etc/ssh/sshd_config <br/>PubkeyAuthentication yes<br/>AuthorizedKeysFile .ssh/authorized_keys<br/>[root@server1 ~]# service sshd restart<br/>Stopping sshd:                                             [  OK  ]<br/>Starting sshd:                                             [  OK  ]</pre><br/>Once that is complete. We can go to our client pc, generate keys, and copy the public key over.<br/><br/>&nbsp;<br/><pre>[root@client1 ~]# ssh-keygen -t rsa<br/>Generating public/private rsa key pair.<br/>Enter file in which to save the key (/root/.ssh/id_rsa): <br/>Enter passphrase (empty for no passphrase): <br/>Enter same passphrase again: <br/>Your identification has been saved in /root/.ssh/id_rsa.<br/>Your public key has been saved in /root/.ssh/id_rsa.pub.<br/>The key fingerprint is:<br/>c6:83:f5:86:ad:cf:06:d3:73:f6:22:8f:0a:a7:06:99 root@client1.example.com<br/>The key's randomart image is:<br/>+--[ RSA 2048]----+<br/>|                 |<br/>|                 |<br/>|        .        |<br/>|       + +       |<br/>|     o. S.+      |<br/>|    E  .o+o o    |<br/>|     .. oo + .   |<br/>|      .+ oo.. .  |<br/>|     .. .o+o..   |<br/>+-----------------+<br/>[root@client1 ~]# ssh-copy-id -i ~/.ssh/id_rsa.pub 192.168.1.1<br/>The authenticity of host '192.168.1.1 (192.168.1.1)' can't be established.<br/>RSA key fingerprint is 40:f4:04:4b:68:53:92:55:82:f2:f4:68:db:0a:14:4f.<br/>Are you sure you want to continue connecting (yes/no)? yes<br/>Warning: Permanently added '192.168.1.1' (RSA) to the list of known hosts.<br/>root@192.168.1.1's password: <br/>Now try logging into the machine, with "ssh '192.168.1.1'", and check in:<br/><br/>  .ssh/authorized_keys<br/><br/>to make sure we haven't added extra keys that you weren't expecting.</pre><br/>Once that has completed, we can ssh to 192.168.1.1 (server1) from client1 without a password, but use a private / public key exchange.<br/><br/>Now, let's configure ntp.<br/><br/>&nbsp;<br/><pre class="crayon-selected">[root@client1 ~]# date<br/>Sun Oct 28 04:32:13 CDT 2012<br/>[root@client1 ~]# yum -y install ntp<br/>[root@client1 ~]# grep server /etc/ntp.conf <br/># Use public servers from the pool.ntp.org project.<br/>server 0.centos.pool.ntp.org<br/>server 1.centos.pool.ntp.org<br/>server 2.centos.pool.ntp.org<br/>#broadcast 192.168.1.255 autokey # broadcast server<br/>#broadcast 224.0.1.1 autokey  # multicast server<br/>#manycastserver 239.255.254.254  # manycast server<br/>#server 127.127.1.0 # local clock<br/>[root@client1 ~]# ntpdate 0.centos.pool.ntp.org<br/>27 Oct 23:33:34 ntpdate[2707]: step time server 66.241.101.63 offset -17998.779036 sec<br/>[root@client1 ~]# date<br/>Sat Oct 27 23:33:37 CDT 2012<br/>[root@client1 ~]# service ntpd start<br/>Starting ntpd:                                             [  OK  ]<br/>[root@client1 ~]# ntpq -p<br/>     remote           refid      st t when poll reach   delay   offset  jitter<br/>==============================================================================<br/> mirror          204.9.54.119     2 u    8   64    1   48.895    1.225   0.000<br/> 71.19.224.242   131.107.13.100   2 u    7   64    1   54.330    0.806   0.000<br/> ntp1.Housing.Be 128.32.206.55    2 u    6   64    1   51.920   -6.134   0.000</pre><br/>If you want to use other peers, you can modify the 'server' directive in /etc/ntpd.conf. Besure to use 'chkconfig' to make ntpd persistent.