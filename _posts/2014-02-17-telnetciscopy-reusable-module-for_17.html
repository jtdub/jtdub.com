---
layout: post
title: |-
  TelnetCisco.py - A Reusable Module for Accessing Cisco Devices with
  Python
date: '2014-02-17T08:36:00.001-06:00'
author: jtdub
tags:
- Cisco Administration Python Scripting
- Python Tips
modified_time: '2019-04-11T11:10:00.233-05:00'
blogger_id: tag:blogger.com,1999:blog-2200496390325245811.post-6052167709562263242
blogger_orig_url: https://www.packetgeek.net/2014/02/telnetciscopy-reusable-module-for_17.html
---

For one reason or another, Python seems to have been my go to scripting language of choice recently. One of the things that I've been working on is creating a reusable python library for accessing Cisco devices via telnet. It's pretty basic code right now, but I'll be expanding upon what I have soon and will be sharing via github.com as well. For now, here is my simple library.
<br/>
<br/>
<br/>
<pre class="lang:default decode:true">class TelnetCisco:<br/>	<br/>	def __init__(self, userName, userPass, enablePass, host):<br/>		self.userName = userName<br/>		self.userPass = userPass<br/>		self.enablePass = enablePass<br/>		self.host = host<br/>		<br/>	def getCreds(self):<br/>		import getpass<br/>		<br/>		self.userName = raw_input("Username: ")<br/>		self.userPass = getpass.getpass("User Password: ")<br/>		self.enablePass = getpass.getpass("Enable Password: ")<br/>		<br/>		return self.userName, self.userPass, self.enablePass<br/>		<br/>	def credsFile(self, authfile):<br/>		import os, sys<br/>		<br/>		if os.path.isfile(authfile):<br/>			login = open(authfile, "r")<br/>			self.userName = login.readline()<br/>			self.userName = self.userName.replace("username = ", "")<br/>			self.userName = self.userName.replace("\n", "")<br/>			self.userPass = login.readline()<br/>			self.userPass = self.userPass.replace("password = ", "")<br/>			self.userPass = self.userPass.replace("\n", "")<br/>			self.enablePass = login.readline()<br/>			self.enablePass = self.enablePass.replace("enable = ", "")<br/>			self.enablePass = self.enablePass.replace("\n", "")<br/>			login.close()<br/>		else:<br/>			print "Error:", authfile, "doesn't exist!"<br/>			sys.exit(2)<br/>			<br/>		return self.userName, self.userPass, self.enablePass<br/><br/>	def devLogin(self, devType):<br/>		import telnetlib, re, sys<br/>		<br/>		TelnetCisco.devType = devType<br/>		telnet = telnetlib.Telnet(self.host)<br/>		<br/>		#usermode = re.match("(.*)" + "&gt;", "&gt;")<br/>		#enablemode = re.match("(.*)", "#")<br/>		<br/>		cmds2exe = ['show arp'] <br/>		<br/>		if devType == "ios":<br/>			telnet.read_until("Username: ", 20)<br/>			telnet.write(self.userName + "\r")<br/>			telnet.read_until("Password: ", 20)<br/>			telnet.write(self.userPass + "\r")<br/>			telnet.read_until(self.host + "&gt;")<br/>			telnet.write("enable\r")<br/>			telnet.read_until("Password: ", 20)<br/>			telnet.write(self.enablePass + "\r")<br/>			telnet.read_until(self.host + "#")<br/>			telnet.write("term length 0\r")<br/>			telnet.read_until(self.host + "#")<br/>			#telnet.write("show arp\r")<br/>			#print telnet.read_until(self.host + "#")<br/>			for command in cmds2exe:<br/>				telnet.write(command + "\r")<br/>				print telnet.read_until(self.host + "#")<br/>			telnet.close()<br/>		else:<br/>			print "Error:", devType, "is unknown by this script.\n"<br/>			sys.exit(2)<br/>		<br/>		return devType, self.host<br/>		<br/>	def codeDebug(self):<br/>		print "### CODE DEBUG ###"<br/>		print "Username:", self.userName<br/>		print "User Password:", self.userPass<br/>		print "Enable Password:", self.enablePass<br/>		print "Host: ", self.host<br/>		print "Device Type: ", TelnetCisco.devType<br/>		print "### CODE DEBUG ###"<br/></pre>
<br/>
<br/>
<br/>
Usage is pretty simple. You need to specify a username, password, enable password, and host variable. To activate the module. The easiest way is to do it within the your python script.
<br/>
<br/>
<br/>
<pre class="lang:default decode:true">import TelnetCisco<br/><br/>username = 'somejoe'<br/>password = 'somepassword'<br/>enable = 'someenable'<br/>host = 'somerouter'<br/><br/>somejob = TelnetCisco(username, password, enable, host)<br/>somejob.devLogin("ios")<br/></pre>
<br/>
<br/>
Of course, the module also has options to specify a authentication file (credsFile(authfile)) or prompt prompt for your credentials (getCreds()). At the moment, the script only runs a 'show arp' on your devices. I'm still working on how I want to implement feeding commands to your devices. I'll post an update as I get more functionality working.
